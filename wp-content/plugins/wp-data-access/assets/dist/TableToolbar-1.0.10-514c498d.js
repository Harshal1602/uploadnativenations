import{r as S,cR as vt,l as M,j as m,cS as yt,bs as ht,bI as bt,cA as gt,b$ as Tt,e as se}from"./main-1.0.10.js";import{u as St,v as xt,B as Se,m as _t,a4 as jt,T as Ot,an as wt,ac as Et}from"./main-1.0.10-f52b9bd1.js";import{P as $}from"./DialogContent-1.0.10-806b7ca9.js";import{e as At,f as Ct}from"./index.esm-1.0.10-b71290a7.js";import{F as Te}from"./FileSaver.min-1.0.10-b9a9d902.js";import{d as Rt}from"./ActionsDml-1.0.10-1992820f.js";import{C as Nt}from"./settings-1.0.10-7d354621.js";import{u as kt}from"./TableContainer-1.0.10-0d1a9d63.js";import{B as le}from"./CardContent-1.0.10-fdbae602.js";import{P as Pt}from"./Menu-1.0.10-18fe74ce.js";import{T as Ft,I as Bt}from"./iconBase-1.0.10-ed1594d9.js";import{R as It}from"./RadioGroup-1.0.10-ba763186.js";import{F as K}from"./FormControlLabel-1.0.10-8c056e28.js";import{R as G}from"./Radio-1.0.10-5d5f37f5.js";import"./Close-1.0.10-2cc4e9e5.js";import"./AdminTheme-1.0.10-77503373.js";import"./Tabs-1.0.10-904035cb.js";import"./index.esm-1.0.10-91acd807.js";import"./TextField-1.0.10-1c88e8ee.js";import"./MenuItem-1.0.10-7183fe69.js";import"./Checkbox-1.0.10-8b17dcc2.js";import"./AlertTitle-1.0.10-f0717848.js";import"./useSlot-1.0.10-af1d07b4.js";import"./InputAdornment-1.0.10-5eb89e09.js";import"./DateTimePicker-1.0.10-db68855b.js";import"./useMobilePicker-1.0.10-2b3a8dee.js";import"./date-time-utils-1.0.10-67dd3a9e.js";import"./dateViewRenderers-1.0.10-487cb75d.js";import"./TimePicker-1.0.10-83f68f18.js";import"./DatePicker-1.0.10-5198465d.js";import"./ScopeEnum-1.0.10-dd8f976d.js";import"./useStoreTable-1.0.10-1f5643a1.js";import"./index.esm-1.0.10-fc952eac.js";import"./index-1.0.10-78ba36f8.js";function ee(e){if(typeof window>"u")return e;const t=S.useRef(null);return S.useLayoutEffect(()=>{t.current=e}),S.useCallback((...o)=>{var c;(c=t.current)===null||c===void 0||c.call(t,...o)},[])}const Ue={};function Mt(e,t){Ue[e]||(Ue[e]=!0,console.error("[material-ui-popup-state] WARNING",t))}const Ut={isOpen:!1,setAnchorElUsed:!1,anchorEl:void 0,anchorPosition:void 0,hovered:!1,focused:!1,_openEventType:null,_childPopupState:null,_deferNextOpen:!1,_deferNextClose:!1};function Lt({parentPopupState:e,popupId:t,variant:o,disableAutoFocus:c}){const y=S.useRef(!0);S.useEffect(()=>(y.current=!0,()=>{y.current=!1}),[]);const[d,b]=S.useState(Ut),p=S.useCallback(f=>{y.current&&b(f)},[]),R=S.useCallback(f=>p(a=>({...a,setAnchorElUsed:!0,anchorEl:f??void 0})),[]),_=ee(f=>(d.isOpen?F(f):N(f),d)),N=ee(f=>{const a=f instanceof Element?void 0:f,T=f instanceof Element?f:(f==null?void 0:f.currentTarget)instanceof Element?f.currentTarget:void 0;if((a==null?void 0:a.type)==="touchstart"){p(x=>({...x,_deferNextOpen:!0}));return}const B=a==null?void 0:a.clientX,P=a==null?void 0:a.clientY,E=typeof B=="number"&&typeof P=="number"?{left:B,top:P}:void 0,I=x=>{if(!f&&!x.setAnchorElUsed&&o!=="dialog"&&Mt("missingEventOrAnchorEl","eventOrAnchorEl should be defined if setAnchorEl is not used"),e){if(!e.isOpen)return x;setTimeout(()=>e._setChildPopupState(w))}const L={...x,isOpen:!0,anchorPosition:E,hovered:(a==null?void 0:a.type)==="mouseover"||x.hovered,focused:(a==null?void 0:a.type)==="focus"||x.focused,_openEventType:a==null?void 0:a.type};return x.setAnchorElUsed||(a!=null&&a.currentTarget?L.anchorEl=a==null?void 0:a.currentTarget:T&&(L.anchorEl=T)),L};p(x=>x._deferNextOpen?(setTimeout(()=>p(I),0),{...x,_deferNextOpen:!1}):I(x))}),k=f=>{const{_childPopupState:a}=f;return setTimeout(()=>{a==null||a.close(),e==null||e._setChildPopupState(null)}),{...f,isOpen:!1,hovered:!1,focused:!1}},F=ee(f=>{const a=f instanceof Element?void 0:f;if((a==null?void 0:a.type)==="touchstart"){p(T=>({...T,_deferNextClose:!0}));return}p(T=>T._deferNextClose?(setTimeout(()=>p(k),0),{...T,_deferNextClose:!1}):k(T))}),z=S.useCallback((f,a)=>{f?N(a):F(a)},[]),X=ee(f=>{const{relatedTarget:a}=f;p(T=>T.hovered&&!(a instanceof Element&&xe(a,w))?T.focused?{...T,hovered:!1}:k(T):T)}),O=ee(f=>{if(!f)return;const{relatedTarget:a}=f;p(T=>T.focused&&!(a instanceof Element&&xe(a,w))?T.hovered?{...T,focused:!1}:k(T):T)}),h=S.useCallback(f=>p(a=>({...a,_childPopupState:f})),[]),w={...d,setAnchorEl:R,popupId:t,variant:o,open:N,close:F,toggle:_,setOpen:z,onBlur:O,onMouseLeave:X,disableAutoFocus:c??!!(d.hovered||d.focused),_setChildPopupState:h};return w}function qt({isOpen:e,popupId:t,variant:o}){return{...o==="popover"?{"aria-haspopup":!0,"aria-controls":e&&t!=null?t:void 0}:o==="popper"?{"aria-describedby":e&&t!=null?t:void 0}:void 0}}function Xt(e){return{...qt(e),onClick:e.open,onTouchStart:e.open}}function Ht({isOpen:e,anchorEl:t,anchorPosition:o,close:c,popupId:y,onMouseLeave:d,disableAutoFocus:b,_openEventType:p}){return{id:y,anchorEl:t,anchorPosition:o,anchorReference:p==="contextmenu"?"anchorPosition":"anchorEl",open:e,onClose:c,onMouseLeave:d,...b&&{disableAutoFocus:!0,disableEnforceFocus:!0,disableRestoreFocus:!0}}}function Jt(e,{popupId:t}){if(!t)return null;const o=typeof e.getRootNode=="function"?e.getRootNode():document;return typeof o.getElementById=="function"?o.getElementById(t):null}function xe(e,t){const{anchorEl:o,_childPopupState:c}=t;return Le(o,e)||Le(Jt(e,t),e)||c!=null&&xe(e,c)}function Le(e,t){if(!e)return!1;for(;t;){if(t===e)return!0;t=t.parentElement}return!1}function He({children:e,popupId:t,variant:o,parentPopupState:c,disableAutoFocus:y}){const d=Lt({popupId:t,variant:o,parentPopupState:c,disableAutoFocus:y}),b=e(d);return b??null}He.propTypes={children:$.func.isRequired,popupId:$.string,variant:$.oneOf(["popover","popper"]).isRequired,parentPopupState:$.object,disableAutoFocus:$.bool};var Wt={fieldSeparator:",",decimalSeparator:".",quoteStrings:!0,quoteCharacter:'"',showTitle:!1,title:"My Generated Report",filename:"generated",showColumnHeaders:!0,useTextFile:!1,useBom:!0,columnHeaders:[],useKeysAsHeaders:!1,boolDisplay:{true:"TRUE",false:"FALSE"},replaceUndefinedWith:""},Kt=`\r
`,Gt="\uFEFF",ae=e=>Object.assign({},Wt,e);class Vt extends Error{constructor(t){super(t),this.name="CsvGenerationError"}}class Yt extends Error{constructor(t){super(t),this.name="EmptyHeadersError"}}class zt extends Error{constructor(t){super(t),this.name="CsvDownloadEnvironmentError"}}class Qt extends Error{constructor(t){super(t),this.name="UnsupportedDataFormatError"}}var Y=e=>e,C=e=>e,te=Y,ce=Y,V=Y,qe=Y,Xe=Y,Zt=function(e,t){return t=='"'&&e.indexOf('"')>-1?e.replace(/"/g,'""'):e},Dt=e=>qe(typeof e=="object"?e.key:e),$t=e=>Xe(typeof e=="object"?e.displayLabel:e),er=(e,...t)=>t.reduce((o,c)=>c(o),e),tr=e=>t=>e.useBom?ce(C(t)+Gt):t,rr=e=>t=>e.showTitle?_e(ce(C(t)+e.title))(V("")):t,_e=e=>t=>ce(C(e)+C(t)+Kt),Je=e=>(t,o)=>nr(e)(V(C(t)+C(o))),nr=e=>t=>Y(C(t)+e.fieldSeparator),or=(e,t)=>o=>{if(!e.showColumnHeaders)return o;if(t.length<1)throw new Yt("Option to show headers but none supplied. Make sure there are keys in your collection or that you've supplied headers through the config options.");let c=V("");for(let y=0;y<t.length;y++){const d=$t(t[y]);c=Je(e)(c,We(e,C(d)))}return c=V(C(c).slice(0,-1)),_e(o)(c)},ir=(e,t,o)=>c=>{let y=c;for(var d=0;d<o.length;d++){let b=V("");for(let p=0;p<t.length;p++){const R=Dt(t[p]),_=o[d][C(R)];b=Je(e)(b,We(e,_))}b=V(C(b).slice(0,-1)),y=_e(y)(b)}return y},sr=e=>+e===e&&(!isFinite(e)||!!(e%1)),lr=(e,t)=>{if(sr(t)){if(e.decimalSeparator==="locale")return te(t.toLocaleString());if(e.decimalSeparator)return te(t.toString().replace(".",e.decimalSeparator))}return te(t.toString())},ue=(e,t)=>{let o=t;return(e.quoteStrings||e.fieldSeparator&&t.indexOf(e.fieldSeparator)>-1||e.quoteCharacter&&t.indexOf(e.quoteCharacter)>-1||t.indexOf(`
`)>-1||t.indexOf("\r")>-1)&&(o=e.quoteCharacter+Zt(t,e.quoteCharacter)+e.quoteCharacter),te(o)},ur=(e,t)=>{const o=t?"true":"false";return te(e.boolDisplay[o])},ar=(e,t)=>typeof t>"u"&&e.replaceUndefinedWith!==void 0?ue(e,e.replaceUndefinedWith+""):t===null?ue(e,"null"):ue(e,""),We=(e,t)=>{if(typeof t=="number")return lr(e,t);if(typeof t=="string")return ue(e,t);if(typeof t=="boolean"&&e.boolDisplay)return ur(e,t);if(t===null||typeof t>"u")return ar(e,t);throw new Qt(`
    typeof ${typeof t} isn't supported. Only number, string, boolean, null and undefined are supported.
    Please convert the data in your object to one of those before generating the CSV.
    `)},cr=e=>t=>{const o=ae(e),c=o.useKeysAsHeaders?Object.keys(t[0]):o.columnHeaders;let y=er(ce(""),tr(o),rr(o),or(o,c),ir(o,c,t));if(C(y).length<1)throw new Vt("Output is empty. Is your data formatted correctly?");return y},dr=e=>t=>{const o=ae(e),c=C(t),y=o.useTextFile?"plain":"csv";return new Blob([c],{type:`text/${y};charset=utf8;`})},fr=e=>t=>{if(!window)throw new zt("Downloading only supported in a browser environment.");const o=dr(e)(t),c=ae(e),y=c.useTextFile?"txt":"csv",d=`${c.filename}.${y}`,b=document.createElement("a");b.download=d,b.href=URL.createObjectURL(o),b.setAttribute("visibility","hidden"),document.body.appendChild(b),b.click(),document.body.removeChild(b)},Ke={};(function(e){(function(t,o){o(e)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:vt,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.toXML=void 0;function o(s){return d(s)||y(s)||k(s)||c()}function c(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function y(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function d(s){if(Array.isArray(s))return F(s)}function b(s,r){var i=Object.keys(s);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(s);r&&(l=l.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),i.push.apply(i,l)}return i}function p(s){for(var r=1;r<arguments.length;r++){var i=arguments[r]!=null?arguments[r]:{};r%2?b(Object(i),!0).forEach(function(l){R(s,l,i[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(i)):b(Object(i)).forEach(function(l){Object.defineProperty(s,l,Object.getOwnPropertyDescriptor(i,l))})}return s}function R(s,r,i){return r in s?Object.defineProperty(s,r,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[r]=i,s}function _(s,r){return X(s)||z(s,r)||k(s,r)||N()}function N(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k(s,r){if(s){if(typeof s=="string")return F(s,r);var i=Object.prototype.toString.call(s).slice(8,-1);if(i==="Object"&&s.constructor&&(i=s.constructor.name),i==="Map"||i==="Set")return Array.from(s);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return F(s,r)}}function F(s,r){(r==null||r>s.length)&&(r=s.length);for(var i=0,l=new Array(r);i<r;i++)l[i]=s[i];return l}function z(s,r){var i=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(i!=null){var l=[],n=!0,u=!1,v,g;try{for(i=i.call(s);!(n=(v=i.next()).done)&&(l.push(v.value),!(r&&l.length===r));n=!0);}catch(j){u=!0,g=j}finally{try{!n&&i.return!=null&&i.return()}finally{if(u)throw g}}return l}}function X(s){if(Array.isArray(s))return s}function O(s){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?O=function(i){return typeof i}:O=function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},O(s)}var h={ARRAY:"array",BOOLEAN:"boolean",DATE:"date",FUNCTION:"function",JSTOXML_OBJECT:"jstoxml-object",NULL:"null",NUMBER:"number",OBJECT:"object",STRING:"string"},w=[h.STRING,h.NUMBER,h.BOOLEAN],f='<?xml version="1.0" encoding="UTF-8"?>',a=["_selfCloseTag","_attrs"],T=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return r.repeat(i)},B=function(r){return Array.isArray(r)&&h.ARRAY||O(r)===h.OBJECT&&r!==null&&r._name&&h.JSTOXML_OBJECT||r instanceof Date&&h.DATE||r===null&&h.NULL||O(r)},P=function(r){return r.startsWith("<![CDATA[")},E=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=arguments.length>2?arguments[2]:void 0,n=r;if(O(r)===h.STRING){if(P(r))return r;var u=new RegExp("(".concat(Object.keys(i).join("|"),")(?!(\\w|#)*;)"),"g");n=String(r).replace(u,function(v,g){return i[g]||""})}return typeof l=="function"?l(n):n},I=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0,l=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,u=Array.isArray(r)?r:Object.entries(r).map(function(v){var g=_(v,2),j=g[0],q=g[1];return R({},j,q)});return u.reduce(function(v,g){var j=Object.keys(g)[0],q=g[j];if(O(l)===h.FUNCTION){var oe=l(j,q);if(oe)return v}var H=i?E(q,i):q,ve=!n&&H===!0?"":'="'.concat(H,'"');return v.push("".concat(j).concat(ve)),v},[])},x=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0,l=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,u=I(r,i,l,n);if(u.length===0)return"";var v=u.join(" ");return" ".concat(v)},L=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(r).map(function(i){return{_name:i,_content:r[i]}})},de=function(r){return w.includes(B(r))},fe=function(r){return!r.match("<")},pe=function(r){var i=r.header,l=r.isOutputStart,n=i&&l;if(!n)return"";var u=O(i)===h.BOOLEAN;return u?f:i},re={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;"},ne=function s(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=i.depth,n=l===void 0?0:l,u=i.indent,v=i._isFirstItem,g=i._isOutputStart,j=g===void 0?!0:g,q=i.header,oe=i.attributeReplacements,H=oe===void 0?{}:oe,ve=i.attributeFilter,je=i.attributeExplicitTrue,Ge=je===void 0?!1:je,Oe=i.contentReplacements,ye=Oe===void 0?{}:Oe,we=i.contentMap,Ee=i.selfCloseTags,Ve=Ee===void 0?!0:Ee,Ye=typeof H=="boolean"&&!H,ze=Ye?{}:p(p({},re),H),Qe=typeof ye=="boolean"&&!ye,Ze=Qe?{}:p(p({},re),ye),Ae=typeof u=="string",he=T(u,n),De=B(r),Ce=pe({header:q,indent:u,depth:n,isOutputStart:j}),ie=j&&!Ce&&v&&n===0,Re=Ae&&!ie?`
`:"",U="";switch(De){case h.JSTOXML_OBJECT:{var J=r._name,W=r._content;if(W===null&&typeof we!="function"){U="".concat(Re).concat(he).concat(J);break}var $e=Array.isArray(W)&&W.every(de);if($e){var et=W.map(function(A){return s({_name:J,_content:A},p(p({},i),{},{depth:n,_isOutputStart:!1}))});return et.join("")}if(a.includes(J))break;var Q=s(W,p(p({},i),{},{depth:n+1,_isOutputStart:ie})),tt=B(Q),rt=fe(Q),nt=P(Q),Ne="".concat(Re).concat(he);if(J==="_comment"){U+="".concat(Ne,"<!-- ").concat(W," -->");break}var ke=tt==="undefined"||Q==="",ot=Ve,Pe=r._selfCloseTag,Fe=O(Pe)===h.BOOLEAN?ke&&Pe:ke&&ot,it=Fe?"/":"",st=x(r._attrs,ze,ve,Ge),lt="<".concat(J).concat(st).concat(it,">"),ut=Ae&&!rt&&!nt?`
`.concat(he):"",at=Fe?"":"".concat(Q).concat(ut,"</").concat(J,">");U+="".concat(Ne).concat(lt).concat(at);break}case h.OBJECT:{var Be=Object.keys(r),ct=Be.map(function(A,Z){var be=p(p({},i),{},{_isFirstItem:Z===0,_isLastItem:Z+1===Be.length,_isOutputStart:ie}),D={_name:A};if(B(r[A])===h.OBJECT){a.forEach(function(ge){var Me=r[A][ge];typeof Me<"u"&&(D[ge]=Me,delete r[A][ge])});var pt=typeof r[A]._content<"u";if(pt&&Object.keys(r[A]).length>1){var Ie=Object.assign({},r[A]);delete Ie._content,D._content=[].concat(o(L(Ie)),[r[A]._content])}}typeof D._content>"u"&&(D._content=r[A]);var mt=s(D,be);return mt},i);U=ct.join("");break}case h.FUNCTION:{var dt=r(i);U=s(dt,i);break}case h.ARRAY:{var ft=r.map(function(A,Z){var be=p(p({},i),{},{_isFirstItem:Z===0,_isLastItem:Z+1===r.length,_isOutputStart:ie});return s(A,be)});U=ft.join("");break}default:{U=E(r,Ze,we);break}}return"".concat(Ce).concat(U)};t.toXML=ne;var me={toXML:ne};t.default=me})})(Ke);const pr=({table:e,appId:t,metaData:o,bulkActions:c,tableStore:y,appLanguage:d,refetch:b})=>{M.debug(t,o);const p=St(),R=y.table,_=y.columns;S.useState("landscape"),S.useState("striped");let N="csv";const[k,F]=S.useState(N),[z,X]=S.useState(!1),O=S.useMemo(()=>xt(),[]),h=kt(t),w=S.useMemo(()=>{const l={};return _.filter(n=>n.lookup!==void 0&&h!==void 0&&h[n.columnName]!==void 0).map(n=>{var u;if(h!==void 0&&h[n.columnName]!==void 0){const v=[];for(const g in h[n.columnName]){const j={key:g,value:Array.isArray(h[n.columnName][g])?h[n.columnName][g].join((u=n.lookup)==null?void 0:u.delimiter):h[n.columnName][g]};v.push(j)}l[n.columnName]=v}}),l},[h,_]);M.debug("lookupColumns",w);const f=S.useMemo(()=>{const l={};return _.filter(n=>n.computedField!==void 0).map(n=>{l[n.columnName]=n.computedField}),l},[_]);M.debug(f);const a=S.useMemo(()=>{const l={};return _.map(n=>{f[n.columnName]?l[n.columnName]=f[n.columnName].label:l[n.columnName]=n.columnLabel}),l},[f,_]);M.debug(a);const T=(l,n)=>{if(w!==void 0&&w[l]!==void 0){const u=w[l].filter(v=>v.key===n);if(Array.isArray(u)&&u.length===1)return u[0].value}return n},B=e.getAllColumns(),P=e.getSelectedRowModel().rows,E=P.map(l=>{const n={};return B.map(u=>{u.id!=="mrt-row-actions"&&u.id!=="mrt-row-select"&&(w!==void 0&&w[u.id]!==void 0?n[a[u.id]]=T(u.id,l.getValue(u.id)):f[u.id]||(n[a[u.id]]=l.getValue(u.id)))}),n});M.debug(E);const I=()=>{var l,n;return(o==null?void 0:o.src)===void 0?t:o.src.app_id&&((n=(l=o==null?void 0:o.app)==null?void 0:l.app[0])==null?void 0:n.app_title)!==""?o.app.app[0].app_title:o.src.dbs?o.src.tbl:t},x=ae({filename:I(),fieldSeparator:",",decimalSeparator:".",useKeysAsHeaders:!0}),L=l=>{const n={};if(o.primary_key&&Array.isArray(o.primary_key))for(let u=0;u<o.primary_key.length;u++){const v=o.primary_key[u];n[v]=l[v]}return n},de=l=>{var n,u,v;for(let g=0;g<((n=o==null?void 0:o.columns)==null?void 0:n.length);g++)if(((u=o==null?void 0:o.columns[g])==null?void 0:u.column_name)===l)return(v=o==null?void 0:o.columns[g])==null?void 0:v.data_type;return"varchar"},fe=async()=>{},pe=()=>{const l=cr(x)(E);fr(x)(l)},re=()=>{Te(new Blob([JSON.stringify(E)],{type:"text/json;charset=utf-8"}),I()+".json")};S.useRef();const ne=()=>{const l=P.map(u=>({row:u.original})),n=Ke.toXML({table:l});Te(new Blob([n],{type:"text/plain;charset=utf-8"}),I()+".xml")},me=()=>{const l=gt(t);M.debug(l);let n="insert into "+l.tbl+" (";for(const u in E[0])n+=u+",";n=n.slice(0,-1)+") values ";for(let u=0;u<E.length;u++){const v=E[u];n+="(";for(const g in v){const j=Tt(de(g));v[g]===null?n+="null,":j==="number"?n+=v[g]+",":n+="'"+v[g]+"',"}n=n.slice(0,-1),n+="),"}n=n.slice(0,-1)+";",Te(new Blob([n],{type:"text/plain;charset=utf-8"}),I()+".sql")},s=()=>{for(let l=0;l<E.length;l++){const n=L(E[l]);Rt(t,n,u=>{if(u!=null&&u.code&&(u!=null&&u.message))switch(u.code){case"ok":se(d.deletedSuccessful,{variant:"success"}),b();break;default:M.error(u),se(u.message??d.invalidResponse,{variant:"error"})}else M.error(u),se(d.invalidResponse,{variant:"error"})},u=>{M.error("error",u),se(u??d.invalidResponse,{variant:"error"})})}e.setRowSelection({})},r=()=>null,i=()=>null;return S.useState(0),S.useState(0),m.jsxs(m.Fragment,{children:[m.jsx(He,{variant:"popover",popupId:O,children:l=>{var n;return m.jsxs(Se,{children:[m.jsx(le,{variant:"contained",endIcon:m.jsx(At,{}),...Xt(l),children:d.bulkActions}),y.state.relTab===!0&&m.jsx(le,{variant:"contained",startIcon:m.jsx(_t,{}),sx:{marginLeft:"10px"},onClick:()=>{p(yt({appId:t}))},children:d.back}),m.jsx(Pt,{...Ht(l),anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},sx:{boxShadow:"0px 5px 5px -3px rgba(0,0,0,0.2),0px 8px 10px 1px rgba(0,0,0,0.14),0px 3px 14px 2px rgba(0,0,0,0.12)"},children:m.jsxs(Se,{sx:{display:"grid",gap:"20px",padding:"20px"},children:[P.length===0&&m.jsx(Ft,{sx:{textAlign:"center",marginTop:"10px"},children:d.noRowsSelected}),m.jsxs(It,{value:k,onChange:(u,v)=>{F(v),u.stopPropagation()},children:[r(),c.csv&&m.jsx(K,{value:"csv",label:d.exportToCsv,control:m.jsx(G,{})}),c.json&&m.jsx(K,{value:"json",label:d.exportToJson,control:m.jsx(G,{})}),i(),c.xml&&m.jsx(K,{value:"xml",label:d.exportToXml,control:m.jsx(G,{})}),c.sql&&!ht(t)&&m.jsx(K,{value:"sql",label:d.exportToSql,control:m.jsx(G,{})}),((n=o==null?void 0:o.privs)==null?void 0:n.delete)&&!bt(o)&&(c==null?void 0:c.delete)===!0&&R.transactions.delete&&m.jsx(K,{value:"delete",label:d.deletePermanently,control:m.jsx(G,{})}),(c.select??!1)&&m.jsx(K,{value:"select",label:d.addSelectedRow,control:m.jsx(G,{})})]}),m.jsx(le,{variant:"contained",onClick:()=>{switch(k){case"pdf":fe();break;case"csv":pe();break;case"json":re();break;case"excel":break;case"xml":ne();break;case"sql":me();break;case"delete":X(!0);break}},disabled:P.length===0,children:d.apply})]})})]})}}),m.jsx(Nt,{title:d.deleteRowsTitle,message:d.deleteRowsMessage,open:z,setOpen:X,onConfirm:()=>{s()},theme:jt})]})},Yr=({table:e,metaData:t,appId:o,bulkActions:c,hasBulkActions:y,tableStore:d,appLanguage:b,refetch:p,showForm:R})=>{var N;const _=d.table;return m.jsxs(Se,{sx:{display:"flex",flexWrap:"nowrap",gap:"8px",alignItems:"center",whiteSpace:"nowrap"},className:"pp-toolbar-buttons",children:[m.jsx(Ot,{arrow:!0,title:b.refresh,className:"ppToolbarRefreshIcon",children:m.jsx(Bt,{onClick:()=>p(),children:m.jsx(wt,{})})}),((N=_==null?void 0:_.transactions)==null?void 0:N.insert)&&m.jsx(le,{variant:"contained",startIcon:m.jsx(Ct,{}),onClick:()=>{R(null,Et.INSERT)},children:b.newRow}),y&&m.jsx(pr,{table:e,appId:o,metaData:t,bulkActions:c,tableStore:d,appLanguage:b,refetch:p})]})};export{Yr as default};
