import{r as d,_ as S,ci as Se,l as o,cj as Ce,ck as Y,cl as se,j as r,P as De,cm as we,b3 as Me,a0 as Te,a1 as D,cn as Fe,co as ke,cp as pe,cq as I,cr as ee,cs as Pe,ct as Ve,e as _,cu as Ae,cv as O,cw as te,cx as Oe,cy as Ye,cc as ae,cz as Le,a4 as Be}from"./main-1.0.10.js";import{b as E,aa as ie,B as L,a4 as Ne,ab as B,S as N,u as Ue,x as ze,a0 as He,v as Ge,g as ne,P as qe,ac as $e,p as Je}from"./main-1.0.10-f52b9bd1.js";import{a as We}from"./AdminTheme-1.0.10-77503373.js";import{s as Qe,u as Xe,i as oe}from"./ActionsDml-1.0.10-1992820f.js";import{C as Ze,a as Ke,B as T}from"./CardContent-1.0.10-fdbae602.js";import{C as Ie}from"./CardActions-1.0.10-2a1d32ba.js";d.lazy(()=>S(()=>import("./TableContainer-1.0.10-0d1a9d63.js").then(t=>t.T),["./TableContainer-1.0.10-0d1a9d63.js","./main-1.0.10.js","./AdminTheme-1.0.10-77503373.js","./iconBase-1.0.10-ed1594d9.js","./index.esm-1.0.10-91acd807.js","./Close-1.0.10-2cc4e9e5.js","./Menu-1.0.10-18fe74ce.js","./main-1.0.10-f52b9bd1.js","./main-1.0.10-ca6efa15.css","./TextField-1.0.10-1c88e8ee.js","./FormControlLabel-1.0.10-8c056e28.js","./CardContent-1.0.10-fdbae602.js","./MenuItem-1.0.10-7183fe69.js","./settings-1.0.10-7d354621.js","./DialogContent-1.0.10-806b7ca9.js","./Tabs-1.0.10-904035cb.js","./settings-1.0.10-5a196fc8.css","./Radio-1.0.10-5d5f37f5.js","./Checkbox-1.0.10-8b17dcc2.js","./AlertTitle-1.0.10-f0717848.js","./useSlot-1.0.10-af1d07b4.js","./InputAdornment-1.0.10-5eb89e09.js","./DateTimePicker-1.0.10-db68855b.js","./useMobilePicker-1.0.10-2b3a8dee.js","./date-time-utils-1.0.10-67dd3a9e.js","./dateViewRenderers-1.0.10-487cb75d.js","./TimePicker-1.0.10-83f68f18.js","./DatePicker-1.0.10-5198465d.js","./ScopeEnum-1.0.10-dd8f976d.js","./ActionsDml-1.0.10-1992820f.js","./useStoreTable-1.0.10-1f5643a1.js","./index.esm-1.0.10-fc952eac.js","./index-1.0.10-78ba36f8.js","./TableContainer-1.0.10-9815a209.css"],import.meta.url));d.lazy(()=>S(()=>Promise.resolve().then(()=>U),void 0,import.meta.url));d.lazy(()=>S(()=>import("./TableContainer-1.0.10-0d1a9d63.js").then(t=>t.T),["./TableContainer-1.0.10-0d1a9d63.js","./main-1.0.10.js","./AdminTheme-1.0.10-77503373.js","./iconBase-1.0.10-ed1594d9.js","./index.esm-1.0.10-91acd807.js","./Close-1.0.10-2cc4e9e5.js","./Menu-1.0.10-18fe74ce.js","./main-1.0.10-f52b9bd1.js","./main-1.0.10-ca6efa15.css","./TextField-1.0.10-1c88e8ee.js","./FormControlLabel-1.0.10-8c056e28.js","./CardContent-1.0.10-fdbae602.js","./MenuItem-1.0.10-7183fe69.js","./settings-1.0.10-7d354621.js","./DialogContent-1.0.10-806b7ca9.js","./Tabs-1.0.10-904035cb.js","./settings-1.0.10-5a196fc8.css","./Radio-1.0.10-5d5f37f5.js","./Checkbox-1.0.10-8b17dcc2.js","./AlertTitle-1.0.10-f0717848.js","./useSlot-1.0.10-af1d07b4.js","./InputAdornment-1.0.10-5eb89e09.js","./DateTimePicker-1.0.10-db68855b.js","./useMobilePicker-1.0.10-2b3a8dee.js","./date-time-utils-1.0.10-67dd3a9e.js","./dateViewRenderers-1.0.10-487cb75d.js","./TimePicker-1.0.10-83f68f18.js","./DatePicker-1.0.10-5198465d.js","./ScopeEnum-1.0.10-dd8f976d.js","./ActionsDml-1.0.10-1992820f.js","./useStoreTable-1.0.10-1f5643a1.js","./index.esm-1.0.10-fc952eac.js","./index-1.0.10-78ba36f8.js","./TableContainer-1.0.10-9815a209.css"],import.meta.url));d.lazy(()=>S(()=>Promise.resolve().then(()=>U),void 0,import.meta.url));d.lazy(()=>S(()=>Promise.resolve().then(()=>U),void 0,import.meta.url));const et=t=>{const u=E(f=>Se(f,t));return o.debug("storeColumns",u),u},tt=t=>{const u=E(f=>Ce(f,t));return o.debug("moreState",u),u},at=d.lazy(()=>S(()=>import("./Row-1.0.10-fcd051a7.js"),["./Row-1.0.10-fcd051a7.js","./main-1.0.10.js","./main-1.0.10-f52b9bd1.js","./iconBase-1.0.10-ed1594d9.js","./main-1.0.10-ca6efa15.css","./AdminTheme-1.0.10-77503373.js","./ActionsDml-1.0.10-1992820f.js","./CardContent-1.0.10-fdbae602.js","./CardActions-1.0.10-2a1d32ba.js"],import.meta.url)),nt=({appId:t,metaData:u,primaryKey:f,formMode:x,formUuid:w})=>{var R;o.debug(t,u,f,x,w);const j=ie(t),C=E(h=>Y(h,t));o.debug("data",C);const g=E(h=>se(h,t));o.debug("initialData",g);let y="30px";return r.jsx("form",{id:w,className:"pp-form-content",onSubmit:h=>(h.preventDefault(),!1),children:r.jsx(L,{className:"pp-form-grid",sx:{display:"grid",gridTemplateColumns:{lg:`repeat(${j.cellsPerRow}, 1fr)`,md:"repeat("+Math.min(j.cellsPerRow,2)+", 1fr)",xs:"1fr"},gap:y,marginBottom:0,background:j.showGrid?((R=Ne)==null?void 0:R.palette.mode)===De.LIGHT?"repeating-linear-gradient( -45deg, transparent, transparent 10px, #eee 10px, #eee 20px )":"repeating-linear-gradient( -45deg, transparent, transparent 10px, #111 10px, #111 20px )":"","& p.MuiFormHelperText-root":{...x===B.VIEW&&!0&&{display:"none"}}},children:r.jsx(d.Suspense,{fallback:r.jsx(N,{}),children:r.jsx(at,{appId:t,metaData:u,data:C,initialData:g,primaryKey:f,formMode:x,formSettings:j})})})})};var ot=we();const p=Me(ot);const rt=d.lazy(()=>S(()=>import("./Alert-1.0.10-a43fcfe4.js"),["./Alert-1.0.10-a43fcfe4.js","./main-1.0.10.js","./index.esm-1.0.10-b71290a7.js","./iconBase-1.0.10-ed1594d9.js","./AlertTitle-1.0.10-f0717848.js","./Close-1.0.10-2cc4e9e5.js","./useSlot-1.0.10-af1d07b4.js"],import.meta.url)),st=({appId:t,primaryKey:u,formMode:f,showTable:x,showForm:w,detailKey:j,children:C,relationAppId:g,relTab:y,joinTab:R,isEmbedded:h})=>{var Z;o.debug(t,u,f,j,g,y,R,h);const b=Ue(),P=et(t),c=ze(t),le=He(),z=d.useMemo(()=>Ge(),[]),[ue,V]=d.useState(!1),[ce,H]=d.useState(!1),[G,me]=d.useState(""),a=d.useMemo(()=>Te(D.getState(),t),[t]);o.debug("metaData",a);const M=Fe((Z=a==null?void 0:a.app)==null?void 0:Z.container[0]),F=E(n=>Y(n,t));o.debug("data",F);const de=E(n=>se(n,t));o.debug("initialData",de);const A=E(n=>ke(n,t));o.debug("m2mUpdate",A),d.useEffect(()=>{A===!0&&k(!1,()=>{b(ee({appId:t,update:!1}))})},[A]),d.useEffect(()=>{u===null?ge():Object.keys(u).length>0?fe():V(!0)},[u]);const fe=()=>{Qe(t,u,a==null?void 0:a.media,n=>{if(o.debug(n),n!==null){const i={...n.context};delete i.debug;const l={...n.data[0]};b(I({appId:t,data:l,context:i})),V(n!==null)}else _(c.invalidResponse,{variant:"error"})},n=>{o.error("error",n),me(n??c.invalidResponse)},!1,y)},ge=()=>{var n,i;if(a.columns&&Array.isArray(a.columns)){const l={},s=pe(D.getState(),t);o.debug("defaultValues",s);for(let e=0;e<a.columns.length;e++)l[a.columns[e].column_name]=null,s[a.columns[e].column_name]!==void 0&&(s[a.columns[e].column_name]==="@wpda_wp_user_id"?l[a.columns[e].column_name]=(i=(n=a==null?void 0:a.settings)==null?void 0:n.env)==null?void 0:i.id:s[a.columns[e].column_name]==="@now"?a.columns[e]==="date"?l[a.columns[e].column_name]=p(Date.now()).format("YYYY-MM-DD"):l[a.columns[e].column_name]=p(Date.now()).format("YYYY-MM-DD HH:mm:ss"):a.columns[e].column_default!==null&&a.columns[e].column_default!==""?a.columns[e].column_default==="CURRENT_TIMESTAMP"?a.columns[e]==="date"?l[a.columns[e].column_name]=p(Date.now()).format("YYYY-MM-DD"):l[a.columns[e].column_name]=p(Date.now()).format("YYYY-MM-DD HH:mm:ss"):l[a.columns[e].column_name]=a.columns[e].column_default:l[a.columns[e].column_name]=s[a.columns[e].column_name]);o.debug(l),b(I({appId:t,data:l,context:{media:{}}})),o.debug("init"),V(!0)}},q=()=>{let n="";for(const i in a.columns)a.columns[i].extra==="auto_increment"&&(n=a.columns[i].column_name);return o.debug(n),n},_e=n=>{for(let i=0;i<a.columns.length;i++)if(a.columns[i].column_name===n)return a.columns[i]},$=n=>{const i=Ae(D.getState(),t);o.debug("rowValidation",i);let l=!1;for(const m in i)if(i[m].error===!0&&i[m].type===O.COLUMN){l=!0;break}if(l)return o.debug("validateForm returned errors"),!1;let s=!0;const e=q();for(const m in n){const v=_e(m);let K=!0;v.column_name!==e&&v.is_nullable==="NO"&&(n[m]===""&&(f===B.INSERT||be.preserveSpacesOnUpdate===!1)||n[m]===null||n[m]===void 0)&&(b(te({appId:t,columnName:m,columnError:!0,columnText:c.mandatoryField,columnType:O.FORM})),K=!1,s=!1);const Ee=Oe(D.getState(),t,m);o.debug(Ee),K&&b(te({appId:t,columnName:m,columnError:!1,columnText:"",columnType:O.FORM}))}return s},k=(n,i)=>{const l=Y(D.getState(),t);if(o.debug(l),$(l)){if(u!==null){const s={};Object.keys(l).map(e=>{P.map(m=>{e===m.columnName&&m.updatable&&(s[e]=l[e])})}),o.debug(s),Xe(t,u,s,e=>{var m;if(o.debug(e),e!=null&&e.code&&(e!=null&&e.message))switch(e.code){case"ok":H(!0),_(c.updatedSuccessful,{variant:"success"}),((m=e.context)==null?void 0:m.updated)!==void 0&&Object.keys(e.context.updated).map(v=>{b(Ye({appId:t,columnName:v,columnValue:e.context.updated[v]}))}),n&&(i!==void 0&&i(u),setTimeout(()=>{x(!0,g)},1e3));break;case"info":_(c.nothingToUpdate,{variant:"info"}),n&&(i!==void 0&&i(u),setTimeout(()=>{x(!0,g)},1e3));break;default:o.error(e),_(e.message??c.invalidResponse,{variant:"error"}),n&&x(!0,g)}else o.error(e),_(c.invalidResponse,{variant:"error"})},e=>{o.error("error",e),_(e??c.invalidResponse,{variant:"error"})},!1,R,y)}else oe(t,l,s=>{if(o.debug(s),s!=null&&s.code&&(s!=null&&s.message)){let e;const m={};switch(s.code){case"ok":H(!0),_(c.insertSuccessful,{variant:"success"}),e=q();for(let v=0;v<a.primary_key.length;v++)e!==""?m[a.primary_key[v]]=s.context.insert_id:m[a.primary_key[v]]=l[a.primary_key[v]];if(o.debug(m),n){i!==void 0&&i(m),x(!0,g);return}w(m,$e.UPDATE);break;default:o.error(s),_(s.message??c.invalidResponse,{variant:"error"})}}else o.error(s),_(c.invalidResponse,{variant:"error"})},s=>{o.error("error",s),_(s??c.invalidResponse,{variant:"error"})},!1,R,y);g!==void 0&&b(ee({appId:g,update:!0}))}},xe=n=>{if(n!==null&&$(F)){const i=ae(D.getState(),t),l=i.state.relation.relation_join_condition.split(",").map(e=>e.split("=")),s={...i.state.detailKey};l.map(e=>{s[e[0]]=F[e[1]]}),oe(t,s,e=>{if(o.debug(e),e!=null&&e.code&&(e!=null&&e.message))switch(e.code){case"ok":o.debug("Added relation to join table",e);break;default:o.error(e),_(e.message??c.invalidResponse,{variant:"error"})}else o.error(e),_(c.invalidResponse,{variant:"error"})},e=>{o.error(e),_(e??c.invalidResponse,{variant:"error"})},!1,!0,!1)}},ve=()=>{k(!1)},he=()=>{const n=ae(D.getState(),t);o.debug(n.state.relation),n.state.relation!==void 0&&n.state.relation.cardinality===Le.MANY_TO_MANY?k(!0,xe):k(!0)},J=()=>{x(ce,g)},be=ie(t),W=E(n=>Pe(n,t));o.debug("moreEnabled",W);const Q=tt(t);ne("(max-width: 600px)"),ne("(max-width: 900px)");const je={paddingTop:"50px",paddingBottom:"50px",paddingLeft:"50px",paddingRight:"50px"};let Re="30px",ye="0";if(G!=="")return r.jsx(d.Suspense,{children:r.jsx(rt,{severity:"error",message:G,close:!1})});const X=()=>r.jsx(nt,{appId:t,metaData:a,primaryKey:u,formMode:f,formUuid:z});return h?X():r.jsx("div",{className:`${t}_wrapper pp-form`,children:ue&&F!==null?r.jsxs(Ze,{sx:je,elevation:le,children:[r.jsxs(Ke,{sx:{padding:0,margin:"5px 0 0 0"},children:[X(),C]}),r.jsxs(Ie,{sx:{marginTop:Re,padding:0,paddingRight:ye,justifyContent:"space-between",alignItems:"center"},children:[r.jsxs(L,{sx:{display:"flex",gap:"8px"},children:[!1,W&&r.jsx(T,{variant:"outlined",startIcon:r.jsx(qe,{}),onClick:()=>{b(Ve({appId:t,more:!Q}))},children:Q?c.less:c.more})]}),r.jsx(L,{children:f!==B.VIEW?r.jsxs(r.Fragment,{children:[r.jsx(T,{variant:"contained",onClick:ve,type:"submit",form:z,children:c.apply}),(M==null?void 0:M.cardinality)!==0&&r.jsxs(r.Fragment,{children:[r.jsx(T,{variant:"outlined",onClick:he,sx:{marginLeft:"8px"},children:c.ok}),r.jsx(T,{variant:"outlined",onClick:J,sx:{marginLeft:"8px"},children:c.cancel})]})]}):r.jsx(r.Fragment,{children:(M==null?void 0:M.cardinality)!==0&&r.jsx(T,{variant:"contained",onClick:J,children:c.back})})})]}),r.jsx(r.Fragment,{children:!1})]}):r.jsx("div",{style:{padding:"50px"},children:r.jsx(N,{title:c.loadingData})})})},it=d.lazy(()=>S(()=>import("./Settings-1.0.10-6f6f5d27.js"),["./Settings-1.0.10-6f6f5d27.js","./main-1.0.10.js","./main-1.0.10-f52b9bd1.js","./iconBase-1.0.10-ed1594d9.js","./main-1.0.10-ca6efa15.css","./AdminTheme-1.0.10-77503373.js","./useMetadataColumns-1.0.10-77c1f86c.js","./useStoreTable-1.0.10-1f5643a1.js","./CardContent-1.0.10-fdbae602.js","./index.esm-1.0.10-4b5803af.js","./ActionsDml-1.0.10-1992820f.js","./index.esm-1.0.10-fc952eac.js","./TextField-1.0.10-1c88e8ee.js","./Close-1.0.10-2cc4e9e5.js","./Menu-1.0.10-18fe74ce.js","./MenuItem-1.0.10-7183fe69.js","./index-1.0.10-ab8af271.js","./useTableUpdater-1.0.10-9bb30d78.js","./Stepper-1.0.10-17f5c392.js","./settings-1.0.10-7d354621.js","./FormControlLabel-1.0.10-8c056e28.js","./DialogContent-1.0.10-806b7ca9.js","./Tabs-1.0.10-904035cb.js","./settings-1.0.10-5a196fc8.css","./Checkbox-1.0.10-8b17dcc2.js","./Link-1.0.10-0c622c62.js","./useSlot-1.0.10-af1d07b4.js","./PremiumFeature-1.0.10-d8bec116.js","./EnumTypeEnum-1.0.10-7ffcf33a.js","./ScopeEnum-1.0.10-dd8f976d.js","./RadioGroup-1.0.10-ba763186.js","./Radio-1.0.10-5d5f37f5.js","./CssUnitTextField-1.0.10-25473ab2.js","./useApp-1.0.10-ec4ceb53.js","./ActionsApp-1.0.10-3d5dae5f.js","./ActionsExplorer-1.0.10-9ae320fe.js","./DefaultWhere-1.0.10-33cd6c20.js","./ThemeSettings-1.0.10-094a6ab1.js","./index-1.0.10-78ba36f8.js"],import.meta.url)),re=({appId:t,primaryKey:u,formMode:f,showTable:x,showForm:w,metaData:j,detailKey:C,selectionForm:g})=>{o.debug(t,u,f,j,C,g);const y=We(),R=d.useMemo(()=>{},[]);o.debug("relationAppId",R);const h=()=>null,b=()=>null,P=()=>null;return r.jsxs(r.Fragment,{children:[g===!0?r.jsx(r.Fragment,{children:h()}):r.jsx(st,{appId:t,primaryKey:u,formMode:f,showTable:x,showForm:w,detailKey:C,relationAppId:R,children:b()}),Be(j)&&r.jsx(Je,{theme:y,children:r.jsx(d.Suspense,{fallback:r.jsx(N,{title:"Loading form settings..."}),children:r.jsx(it,{appId:t})})}),P()]})},U=Object.freeze(Object.defineProperty({__proto__:null,FormContainer:re,default:re},Symbol.toStringTag,{value:"Module"}));export{U as F,tt as a,p as d,et as u};
