import{a0 as He,l,r as b,bi as qe,a1 as Q,cn as Pe,cT as ge,cU as Ye,cV as Je,cW as De,cX as Le,j as e,cY as ae,b$ as me,cZ as Me,c_ as $e,_ as Ke,c$ as Xe,bY as Ze,F as J,d0 as oe,d1 as Qe,d2 as Ie,d3 as es,d4 as ss,d5 as ts,d6 as is,d7 as T,d8 as ns,d9 as se,cz as G,da as rs,a as ls,e as P,C as D,db as as,dc as de,dd as os,bm as ds,P as cs,de as ps,v as ve,x as us,df as xs,dg as hs,dh as gs}from"./main-1.0.10.js";import{b as $,u as _,v as ms,aa as Ee,M as W,B as u,ap as js,ag as we,aq as fs,aj as bs,ak as ys,al as Cs,am as Ss,D as Ne,c as je,T as fe,ar as Ts,m as vs,n as ws,o as Oe,f as Ve,R as Fs,s as _s,C as Rs,as as ks,A as Us,e as As}from"./main-1.0.10-f52b9bd1.js";import{A as Fe}from"./AdminTheme-1.0.10-77503373.js";import{u as Ps,S as Ls,a as Es,I as ie,b as Ns,c as Os,d as ce,T as Vs,M as Gs,P as zs,D as Bs,e as Ws,f as Hs,g as qs,h as Ys,i as Js}from"./useMetadataColumns-1.0.10-77c1f86c.js";import{a as X,C as Se,S as Te,R as Ds,B as Ms,b as $s,c as Ks,d as Xs,e as pe,k as Zs}from"./settings-1.0.10-7d354621.js";import{h as Qs,f as Is,g as et}from"./index.esm-1.0.10-fc952eac.js";import{u as Ge}from"./useStoreTable-1.0.10-1f5643a1.js";import{d as st,e as tt,c as it}from"./index.esm-1.0.10-4b5803af.js";import{P as K}from"./PremiumFeature-1.0.10-d8bec116.js";import{E as ue}from"./EnumTypeEnum-1.0.10-7ffcf33a.js";import{A as H,a as q,b as Y,L as ee}from"./Link-1.0.10-0c622c62.js";import{F,b as N,a as w,T as O,I as be,S as ye}from"./TextField-1.0.10-1c88e8ee.js";import{a as nt,S as rt}from"./ScopeEnum-1.0.10-dd8f976d.js";import{R as Ce}from"./RadioGroup-1.0.10-ba763186.js";import{R as z}from"./Radio-1.0.10-5d5f37f5.js";import{I as B,T as ze}from"./iconBase-1.0.10-ed1594d9.js";import{F as I}from"./FormControlLabel-1.0.10-8c056e28.js";import{C as L}from"./CssUnitTextField-1.0.10-25473ab2.js";import{u as lt,C as at,a as _e,b as Re}from"./useApp-1.0.10-ec4ceb53.js";import{D as ot,T as dt,a as xe}from"./DefaultWhere-1.0.10-33cd6c20.js";import{M as te}from"./MenuItem-1.0.10-7183fe69.js";import{j as ct,k as pt,l as ut}from"./ActionsApp-1.0.10-3d5dae5f.js";import{S as xt,a as ht,b as gt}from"./Stepper-1.0.10-17f5c392.js";import{B as M,C as ke,a as Ue}from"./CardContent-1.0.10-fdbae602.js";import"./index-1.0.10-ab8af271.js";import mt from"./ThemeSettings-1.0.10-094a6ab1.js";import{T as he}from"./Tabs-1.0.10-904035cb.js";import"./ActionsDml-1.0.10-1992820f.js";import"./Menu-1.0.10-18fe74ce.js";import"./useTableUpdater-1.0.10-9bb30d78.js";import"./Checkbox-1.0.10-8b17dcc2.js";import"./Close-1.0.10-2cc4e9e5.js";import"./DialogContent-1.0.10-806b7ca9.js";import"./useSlot-1.0.10-af1d07b4.js";import"./ActionsExplorer-1.0.10-9ae320fe.js";import"./index-1.0.10-78ba36f8.js";const ne=s=>{const n=$(t=>He(t,s));return l.debug("metaData",n),n},Be=s=>{const n=_();return b.useCallback((t,i)=>{ct({app_id:t.app.app[0].app_id,cnt_id:t.app.container[0].cnt_id},r=>{const o=r==null?void 0:r.data;if(l.debug("response data",o),Array.isArray(o)){const a=qe(Q.getState(),s)??[];for(let m=0;m<o.length;m++){const v=Pe(o[m]);if(v!==null&&v.cnt_id_master===t.app.container[0].cnt_id){let g="";for(let d=0;d<a.length;d++)ge(Q.getState(),a[d].appId)!==void 0&&a[d].container.cnt_id===o[m].cnt_id&&(g=a[d].appId);if(g===""){const d={appId:ms(),container:o[m]};n(Ye({appId:s,detail:d}))}else{const d={appId:g,container:o[m]};n(Je({appId:s,detail:d}))}}}}else l.error("error loading details",r),i!==void 0&&i()},r=>{l.error("error loading details",r),i!==void 0&&i()})},[s])},jt=s=>{const n=$(t=>De(t,s));return l.debug("detailDisplayType",n),n},E=s=>{const n=_();return i=>{n(Le({appId:s,isUpdated:i}))}},ft=({appId:s,columnIndex:n,tableColumn:t})=>{l.debug(s,n,t),_();const i=ne(s),r=Ee(s);E(s);const o=a=>[];return e.jsxs(H,{disableGutters:!0,children:[e.jsxs(q,{expandIcon:e.jsx(W,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(st,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Grid positioning"})]}),e.jsxs(Y,{sx:{paddingTop:"0.5rem"},children:[e.jsxs(u,{children:[e.jsxs(F,{sx:{display:"grid"},children:[e.jsx(N,{children:"Grid cells"}),e.jsx(nt,{value:t.cells,min:1,max:r.cellsPerRow,step:1,marks:o(r.cellsPerRow),valueLabelDisplay:"auto",disabled:!0,onChange:(a,m)=>{l.debug(a,m)},sx:{width:"calc(100% - 40px)",margin:"20px"}})]}),e.jsx(w,{children:"Number of grid cells used (can be changed in FORM > Grid)."}),e.jsxs(F,{sx:{width:"100%"},children:[e.jsx(N,{sx:{margin:"15px 0 5px 0"},children:"Grid positioning"}),e.jsx(Ce,{sx:{flexDirection:"column",alignContent:"flex-start",marginLeft:"10px",marginBottom:"5px"},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",justifyContent:"center",alignItems:"center"},children:[e.jsxs(N,{className:"align-label-radio",children:[e.jsx(z,{checked:t.cellClass===ae.AUTO,disabled:!0,onChange:a=>{a.stopPropagation()}}),"Auto"]}),e.jsxs(N,{className:"align-label-radio",children:[e.jsx(z,{checked:t.cellClass===ae.START,disabled:!0,onChange:a=>{a.stopPropagation()}}),"Start"]}),e.jsxs(N,{className:"align-label-radio",children:[e.jsx(z,{checked:t.cellClass===ae.END,disabled:!0,onChange:a=>{a.stopPropagation()}}),"End"]}),e.jsxs(N,{children:[e.jsx(z,{checked:typeof t.cellClass=="number",disabled:!0,onChange:a=>{a.stopPropagation()}}),"Add"]}),e.jsxs("div",{style:{marginLeft:"10px",gridColumn:"span 2",display:"grid",gridTemplateColumns:"auto auto",alignItems:"center"},children:[e.jsx(O,{id:"pp-cells-before",sx:{width:"60px"},className:"pp-cells-before",type:"number",defaultValue:1,InputProps:{inputProps:{min:1,max:r.cellsPerRow-1}},disabled:!0,InputLabelProps:{shrink:!0},onChange:a=>{a.stopPropagation()}}),e.jsx(N,{sx:{marginLeft:"10px"},children:"cell(s) before"})]})]})})]}),e.jsx(w,{children:"Grid positioning relative to surrounding cells."}),t.computedField&&n!==void 0&&(i==null?void 0:i.columns[n])!==void 0&&i.columns[n].data_type==="enum"&&e.jsxs(u,{sx:{marginTop:"20px"},children:[e.jsx(N,{children:"Show values in"}),e.jsxs(Ce,{sx:{flexDirection:"column",alignContent:"flex-start",margin:"10px 0 5px 10px"},children:[e.jsxs(N,{className:"align-label-radio",children:[e.jsx(z,{checked:t.updatableEnum===void 0||t.updatableEnum===ue.LIST,disabled:!0,onChange:a=>{a.stopPropagation()}}),"Drop-down List"]}),e.jsxs(N,{className:"align-label-radio",children:[e.jsx(z,{checked:t.updatableEnum===ue.RADIO_HORIZONTAL,disabled:!0,onChange:a=>{a.stopPropagation()}}),"Horizontal radio group"]}),e.jsxs(N,{className:"align-label-radio",children:[e.jsx(z,{checked:t.updatableEnum===ue.RADIO_VERTICAL,disabled:!0,onChange:a=>{a.stopPropagation()}}),"Vertical radio group"]})]})]})]}),e.jsx(K,{single:!1})]})]})},bt=({appId:s,columnIndex:n,tableColumn:t,columnMetaData:i})=>{l.debug(s,n,t),_(),E(s);const[r,o]=b.useState(!1);return t.computedField!==void 0||n===void 0||i===void 0||(i==null?void 0:i.data_type)!==void 0&&me(i.data_type)!=="number"?null:e.jsxs(H,{disableGutters:!0,children:[e.jsxs(q,{expandIcon:e.jsx(W,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(tt,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Validation"})]}),e.jsxs(Y,{sx:{paddingTop:"1rem"},children:[e.jsxs(F,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px"},children:[e.jsx(O,{error:r,type:"number",label:"Minimum value allowed",disabled:!0,value:t.numericMin??"",required:!1,InputLabelProps:{shrink:!0},onChange:a=>{l.debug(a)}}),e.jsx(O,{error:r,type:"number",label:"Maximum value allowed",disabled:!0,value:t.numericMax??"",required:!1,InputLabelProps:{shrink:!0},onChange:a=>{l.debug(a)}})]}),e.jsx(K,{})]})]})},yt=({appId:s,columnIndex:n,tableColumn:t,columnMetaData:i})=>{l.debug(s,n,t,i);const r=_(),o=E(s),[a,m]=b.useState(!1),v={marginTop:"20px",marginLeft:"10px"};return e.jsxs(H,{disableGutters:!0,children:[e.jsxs(q,{expandIcon:e.jsx(W,{}),sx:{fontSize:"1rem","& .MuiAccordionSummary-content":{padding:"1rem",alignItems:"center"}},children:[e.jsx(it,{}),e.jsx("span",{style:{paddingLeft:"0.5rem"},children:"Column settings"})]}),e.jsxs(Y,{sx:{display:"grid",gridGap:"2rem",paddingTop:"1rem"},children:[e.jsxs(F,{children:[e.jsx(O,{type:"text",variant:"outlined",label:"Default value",value:t.defaultValue??"",placeholder:(i==null?void 0:i.column_default)??"",InputLabelProps:{shrink:!0},onChange:g=>{r(Me({appId:s,index:n,defaultValue:g.target.value})),o(!0),g.stopPropagation()}}),e.jsxs(w,{component:"div",children:[e.jsx(e.Fragment,{children:(i==null?void 0:i.column_default)!==void 0&&(i==null?void 0:i.column_default)!==null&&(i==null?void 0:i.column_default)!==""&&e.jsx(u,{sx:{fontWeight:"bold"},children:"Leave empty to use column default constraint."})}),e.jsxs("div",{children:["Only applied on insert ",a?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:e.jsx(ee,{sx:{cursor:"pointer"},underline:"none",onClick:()=>{m(!1)},children:"(hide examples)"})}),e.jsxs("ul",{style:{listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"Hello World"}),e.jsx("li",{children:"@wpda_wp_user_id"}),e.jsx("li",{children:"@now"})]}),e.jsx("div",{style:v,children:"Notes"}),e.jsxs("ul",{style:{listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"@wpda_wp_user_id returns the WordPress user ID or 0 for anonymous requests"}),e.jsx("li",{children:"@now returns the current date/time and works with date/time fields only"}),e.jsxs("li",{children:["Column default constraints defined in the database are automatically applied",(i==null?void 0:i.column_default)!==void 0&&(i==null?void 0:i.column_default)!==null&&(i==null?void 0:i.column_default)!==""&&e.jsxs(e.Fragment,{children:[" (current value is ",e.jsx("strong",{children:i==null?void 0:i.column_default}),")"]})]})]})]}):e.jsx("span",{children:e.jsx(ee,{sx:{cursor:"pointer"},underline:"none",onClick:()=>{m(!0)},children:"(show examples)"})})]})]})]}),((i==null?void 0:i.data_type)!==void 0&&i.data_type.toLowerCase()!=="text"&&i.data_type.toLowerCase()!=="enum"&&i.data_type.toLowerCase()!=="set"&&i.column_type.toLowerCase()!=="tinyint(1)"&&(me(i.data_type)==="string"||me(i.data_type)==="number")||t.computedField)&&e.jsxs(F,{children:[e.jsx(u,{sx:{display:"grid",gridTemplateColumns:"auto auto",gridGap:"10px",alignItems:"center"},children:e.jsxs(e.Fragment,{children:[e.jsx(O,{type:"text",variant:"outlined",label:"Prefix",value:t.prefix,disabled:!0,InputLabelProps:{shrink:!0},onChange:g=>{g.stopPropagation()}}),e.jsx(O,{type:"text",variant:"outlined",label:"Suffix",value:t.suffix,disabled:!0,InputLabelProps:{shrink:!0},onChange:g=>{g.stopPropagation()}})]})}),e.jsx(w,{children:"Adds a prefix and/or suffix to the column content."})]}),e.jsxs(F,{children:[e.jsx(O,{type:"text",variant:"outlined",label:"CSS classes",fullWidth:!0,value:t.classNames,disabled:!0,InputLabelProps:{shrink:!0},onChange:g=>{g.stopPropagation()}}),e.jsx(w,{children:"CSS classes (seperated by spaces) for custom styling."})]}),e.jsxs(F,{children:[e.jsx(O,{type:"text",variant:"outlined",label:"Hint",fullWidth:!0,value:t.hint,disabled:!0,InputLabelProps:{shrink:!0},onChange:g=>{g.stopPropagation()}}),e.jsx(w,{children:"Help text displayed below data entry field."})]}),e.jsx(K,{single:!1,margin:"0"})]})]})},Ct=({appId:s,columnIndex:n,tableColumn:t})=>{var d,C;l.debug(s,n,t);const i=_(),r=E(s),o=Ge(s),a=ne(s),v=Ps(s)[t.columnName],g=(R,x)=>{i($e({appId:s,index:R,lookup:x})),r(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(ft,{appId:s,columnIndex:n,tableColumn:t}),e.jsx(yt,{appId:s,columnIndex:n,tableColumn:t,columnMetaData:v}),(((d=a==null?void 0:a.privs)==null?void 0:d.insert)||((C=a==null?void 0:a.privs)==null?void 0:C.update))&&(o.table.transactions.insert||o.table.transactions.update)&&e.jsx(bt,{appId:s,columnIndex:n,tableColumn:t,columnMetaData:v}),e.jsx(Ls,{appId:s,columnIndex:n,tableColumn:t,columnMetaData:v,setLookup:g}),e.jsx(Es,{columnMetaData:v})]})};b.lazy(()=>Ke(()=>import("./ComputedFieldMore-1.0.10-eb77e9bb.js"),["./ComputedFieldMore-1.0.10-eb77e9bb.js","./main-1.0.10.js","./main-1.0.10-f52b9bd1.js","./iconBase-1.0.10-ed1594d9.js","./main-1.0.10-ca6efa15.css","./settings-1.0.10-7d354621.js","./FormControlLabel-1.0.10-8c056e28.js","./TextField-1.0.10-1c88e8ee.js","./Close-1.0.10-2cc4e9e5.js","./Menu-1.0.10-18fe74ce.js","./DialogContent-1.0.10-806b7ca9.js","./AdminTheme-1.0.10-77503373.js","./CardContent-1.0.10-fdbae602.js","./Tabs-1.0.10-904035cb.js","./settings-1.0.10-5a196fc8.css","./index.esm-1.0.10-fc952eac.js","./MenuItem-1.0.10-7183fe69.js"],import.meta.url));const St=({appId:s,columnIndex:n})=>{l.debug(s,n);const t=_(),i=Ge(s),r=$(c=>Xe(c,s,n));l.debug("tableColumn",r);const o=E(s),a=(c,p)=>{l.debug(c,p),t(Qe({appId:s,index:c,visible:p})),o(!0)},m=(c,p)=>{l.debug(c,p),t(Ie({appId:s,index:c,more:p})),o(!0)},v=(c,p)=>{l.debug(c,p),t(es({appId:s,index:c,updatable:p})),o(!0)};Ze.TEXT;const[g,d]=b.useState(!1),[C,R]=b.useState(void 0),x=c=>{c!==void 0&&(t(ss({appId:s,index:c})),o(!0))},k=(c,p,S)=>(l.debug(c,p,S),e.jsxs(e.Fragment,{children:[e.jsx(u,{children:e.jsx(Ns,{id:c,enabled:!1})}),e.jsxs(u,{sx:{display:"inline-grid",gridTemplateColumns:r.computedField!==void 0?"auto auto":"auto",justifyContent:"start",alignItems:"center",gap:"10px","& svg":{opacity:"0.5"}},children:[r.computedField!==void 0&&e.jsx(Qs,{}),e.jsx(N,{children:p})]})]}));return e.jsxs(e.Fragment,{children:[e.jsxs(H,{disableGutters:!0,slotProps:{transition:{unmountOnExit:!0}},children:[e.jsxs(q,{className:"pp-column-settings",expandIcon:e.jsx(W,{}),sx:{justifyContent:"space-between"},children:[e.jsx(u,{sx:{display:"grid",gridTemplateColumns:"auto 1fr",alignItems:"center","& svg":{display:"flex"}},children:k(r.columnName,r.columnLabel,n)}),e.jsxs(u,{style:{display:"grid",gridTemplateColumns:"40px 40px 40px"},children:[e.jsx(X,{title:"Visibility",position:"bottom",children:e.jsx(B,{onClick:c=>{r.visible?r.more?(a(n,!1),m(n,!1)):m(n,!0):r.more?m(n,!1):a(n,!0),c.stopPropagation()},children:r.visible?e.jsx(e.Fragment,{children:r.more?e.jsx(ie,{checked:!0,children:e.jsx(js,{})}):e.jsx(ie,{checked:!0,children:e.jsx(we,{})})}):e.jsx(ie,{checked:!1,children:e.jsx(we,{})})})}),r.computedField?e.jsx(e.Fragment,{children:e.jsx(X,{title:"Delete",position:"bottom",children:e.jsx(B,{onClick:c=>{d(!0),R(n),c.stopPropagation()},children:e.jsx(bs,{})})})}):e.jsx(X,{title:"Updatable",position:"bottom",disabled:!i.table.transactions.insert&&!i.table.transactions.update,children:e.jsx(B,{disabled:!i.table.transactions.insert&&!i.table.transactions.update,onClick:c=>{v(n,!r.updatable),c.stopPropagation()},children:e.jsx(ie,{checked:r.updatable&&(i.table.transactions.insert||i.table.transactions.update),disabled:!i.table.transactions.insert&&!i.table.transactions.update,children:e.jsx(fs,{})})})}),e.jsx(X,{title:"Alignment",position:"bottom",children:e.jsxs(B,{onClick:c=>{r.alignment===J.LEFT?t(oe({appId:s,index:n,alignment:J.CENTER})):r.alignment===J.CENTER?t(oe({appId:s,index:n,alignment:J.RIGHT})):r.alignment===J.RIGHT&&t(oe({appId:s,index:n,alignment:J.LEFT})),o(!0),c.stopPropagation()},children:[r.alignment===J.LEFT&&e.jsx(ys,{}),r.alignment===J.CENTER&&e.jsx(Cs,{}),r.alignment===J.RIGHT&&e.jsx(Ss,{})]})})]})]}),e.jsx(Y,{children:e.jsx(Ct,{appId:s,columnIndex:n,tableColumn:r})})]},n),e.jsx(Se,{title:"Delete computed field?",message:"Are you sure you want to delete this computed field? This action cannot be undone!",open:g,setOpen:d,onConfirm:()=>x(C)})]})},Tt=({appId:s})=>{l.debug(s),_();const n=Os(ce(zs),ce(Gs),ce(Vs));E(s);const t=r=>{const{active:o,over:a}=r;(o==null?void 0:o.id)!==(a==null?void 0:a.id)&&l.debug(o,a)},i=$(r=>ts(r,s));return i===void 0||i.length===0?null:e.jsxs(e.Fragment,{children:[e.jsx(Bs,{autoScroll:!0,sensors:n,collisionDetection:Ws,onDragEnd:t,children:e.jsx(Hs,{items:i,children:i.map((r,o)=>e.jsx(qs,{id:r,children:e.jsx(St,{appId:s,columnIndex:o})},r))})}),e.jsx(Ys,{appId:s,target:Ne.FORM})]})},vt=()=>{const s=$(n=>is(n));return l.debug("hideThemeSetting",s),s},wt=({appId:s,formSettings:n})=>(_(),E(s),e.jsxs(H,{defaultExpanded:!1,disableGutters:!0,children:[e.jsx(q,{expandIcon:e.jsx(W,{}),children:"Field layout"}),e.jsxs(Y,{sx:{display:"grid",gap:"20px"},children:[e.jsxs(F,{children:[e.jsxs(Ce,{value:n.fieldVariant,sx:{flexDirection:"row"},onChange:t=>{l.debug(t)},children:[e.jsx(I,{control:e.jsx(z,{disabled:!0}),value:"outlined",label:"Outlined"},"outlined"),e.jsx(I,{control:e.jsx(z,{disabled:!0}),value:"filled",label:"Filled"},"filled"),e.jsx(I,{control:e.jsx(z,{disabled:!0}),value:"standard",label:"Standard"},"standard")]}),e.jsx(w,{children:"Applies to data entry forms only."})]}),e.jsx(I,{control:e.jsx(Te,{checked:n.hideHintsInViewMode,disabled:!0,onChange:(t,i)=>{t.stopPropagation()}}),label:"Hide hints in view mode",labelPlacement:"end"}),e.jsx(K,{})]})]})),Ft=({appId:s,formSettings:n,updateSettings:t})=>{_(),E(s);const[i,r]=b.useState(!1);return e.jsxs(H,{defaultExpanded:!1,disableGutters:!0,children:[e.jsx(q,{expandIcon:e.jsx(W,{}),children:"Grid"}),e.jsxs(Y,{sx:{display:"grid",gridTemplateColumns:"repeat(1, 1fr)",gap:"20px",marginTop:"5px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px"},children:[e.jsx(O,{type:"number",label:"Cells per row",value:n.cellsPerRow,disabled:!0,InputLabelProps:{shrink:!0},onChange:o=>{l.debug(o)}}),e.jsx(L,{label:"Space between cells",textField:{cssValue:n.spacing.betweenCells,cssUnit:n.spacing.betweenCellsUnit},defaultValue:{cssValue:T.betweenCells,cssUnit:T.betweenCellsUnit},updateSettings:o=>{l.debug(o)}})]}),e.jsx(I,{control:e.jsx(Te,{disabled:!0,checked:n.showGrid,onChange:(o,a)=>{l.debug(o,a)}}),label:"Show grid"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",marginTop:"10px"},children:[e.jsx(L,{label:"Padding top",textField:{cssValue:n.spacing.aroundGridTop,cssUnit:n.spacing.aroundGridTopUnit},defaultValue:{cssValue:T.aroundGridTop,cssUnit:T.aroundGridTopUnit},updateSettings:o=>{l.debug(o)}}),e.jsx(L,{label:"Padding bottom",textField:{cssValue:n.spacing.aroundGridBottom,cssUnit:n.spacing.aroundGridBottomUnit},defaultValue:{cssValue:T.aroundGridBottom,cssUnit:T.aroundGridBottomUnit},updateSettings:o=>{l.debug(o)}}),e.jsx(L,{label:"Padding left",textField:{cssValue:n.spacing.aroundGridLeft,cssUnit:n.spacing.aroundGridLeftUnit},defaultValue:{cssValue:T.aroundGridLeft,cssUnit:T.aroundGridLeftUnit},updateSettings:o=>{l.debug(o)}}),e.jsx(L,{label:"Padding right",textField:{cssValue:n.spacing.aroundGridRight,cssUnit:n.spacing.aroundGridRightUnit},defaultValue:{cssValue:T.aroundGridRight,cssUnit:T.aroundGridRightUnit},updateSettings:o=>{l.debug(o)}})]}),e.jsxs(w,{component:"div",sx:{marginTop:"10px"},children:[e.jsxs(ee,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>r(!i),children:[e.jsx(je,{}),"How to use the grid?"]}),i&&e.jsxs(u,{sx:{marginTop:"20px",display:"grid",gap:"20px"},children:[e.jsxs(u,{children:["All form fields are organized into a form grid, which consists of ",e.jsx("strong",{children:"rows"})," and ",e.jsx("strong",{children:"cells"}),'. Each row contains a fixed number of cells, determined by the "Cells per row" setting. The grid ensures consistent layout and alignment for all form fields.']}),e.jsxs(u,{children:["Each form field can occupy from 1 to n cells, where n is the number of cells per row. This value can be adjusted on a per-column basis in ",e.jsx("strong",{children:"Grid positioning"}),". To access the grid position for a specific column, open the ",e.jsx("strong",{children:"COLUMNS"})," section, navigate to the column, and select the ",e.jsx("strong",{children:"Grid positioning"})," option. Grid positioning allows you to adjust the display of empty cells before a field or position a field at the beginning or end of a row."]}),e.jsxs(u,{children:["The grid can be displayed during form design to visualize column positioning and spacing. This feature is available only in the ",e.jsx("strong",{children:"Form Builder"})," and is not visible during runtime."]})]})]}),e.jsx(K,{single:!1})]})]})},_t=({formSettings:s,updateSettings:n})=>e.jsxs(H,{defaultExpanded:!1,disableGutters:!0,children:[e.jsx(q,{expandIcon:e.jsx(W,{}),children:"Cells"}),e.jsxs(Y,{style:{display:"grid",gridTemplateColumns:"repeat(1, 1fr)"},children:[e.jsxs(F,{children:[e.jsxs(u,{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",marginTop:"5px"},children:[e.jsx(L,{label:"Padding top",textField:{cssValue:s.spacing.cellTop,cssUnit:s.spacing.cellTopUnit},defaultValue:{cssValue:T.cellTop,cssUnit:T.cellTopUnit},updateSettings:t=>{l.debug(t)}}),e.jsx(L,{label:"Padding bottom",textField:{cssValue:s.spacing.cellBottom,cssUnit:s.spacing.cellBottomUnit},defaultValue:{cssValue:T.cellBottom,cssUnit:T.cellBottomUnit},updateSettings:t=>{l.debug(t)}}),e.jsx(L,{label:"Padding left",textField:{cssValue:s.spacing.cellLeft,cssUnit:s.spacing.cellLeftUnit},defaultValue:{cssValue:T.cellLeft,cssUnit:T.cellLeftUnit},updateSettings:t=>{l.debug(t)}}),e.jsx(L,{label:"Padding right",textField:{cssValue:s.spacing.cellRight,cssUnit:s.spacing.cellRightUnit},defaultValue:{cssValue:T.cellRight,cssUnit:T.cellRightUnit},updateSettings:t=>{l.debug(t)}})]}),e.jsx(w,{sx:{marginTop:"20px"},children:"Spacing around cells."})]}),e.jsx(K,{single:!1})]})]}),Rt=({formSettings:s,updateSettings:n})=>e.jsxs(H,{defaultExpanded:!1,disableGutters:!0,children:[e.jsx(q,{expandIcon:e.jsx(W,{}),children:"Field spacing"}),e.jsxs(Y,{sx:{display:"grid"},children:[e.jsxs(F,{children:[e.jsxs(u,{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",marginTop:"5px"},children:[e.jsx(L,{label:"Padding top",textField:{cssValue:s.spacing.fieldTop,cssUnit:s.spacing.fieldTopUnit},defaultValue:{cssValue:T.fieldTop,cssUnit:T.fieldTopUnit},updateSettings:t=>{l.debug(t)}}),e.jsx(L,{label:"Padding bottom",textField:{cssValue:s.spacing.fieldBottom,cssUnit:s.spacing.fieldBottomUnit},defaultValue:{cssValue:T.fieldBottom,cssUnit:T.fieldBottomUnit},updateSettings:t=>{l.debug(t)}}),e.jsx(L,{label:"Padding left",textField:{cssValue:s.spacing.fieldLeft,cssUnit:s.spacing.fieldLeftUnit},defaultValue:{cssValue:T.fieldLeft,cssUnit:T.fieldLeftUnit},updateSettings:t=>{l.debug(t)}}),e.jsx(L,{label:"Padding right",textField:{cssValue:s.spacing.fieldRight,cssUnit:s.spacing.fieldRightUnit},defaultValue:{cssValue:T.fieldRight,cssUnit:T.fieldRightUnit},updateSettings:t=>{l.debug(t)}})]}),e.jsx(w,{sx:{marginTop:"20px"},children:"Spacing within data entry fields."})]}),e.jsx(K,{single:!1})]})]}),kt=({appId:s,formSettings:n})=>{var o;const t=_(),i=E(s),r=ne(s);return!((o=r==null?void 0:r.privs)!=null&&o.update)||r.primary_key.length===0?null:e.jsxs(H,{defaultExpanded:!1,disableGutters:!0,children:[e.jsx(q,{expandIcon:e.jsx(W,{}),children:"Null value handling"}),e.jsxs(Y,{sx:{display:"grid"},children:[e.jsx(I,{control:e.jsx(Te,{checked:n.preserveSpacesOnUpdate,onChange:(a,m)=>{t(ns({appId:s,preserveSpaces:m})),i(!0),a.stopPropagation()}}),label:"Preserve empty strings on update",labelPlacement:"end"}),e.jsx(w,{children:"Enable to preserve empty strings for mandatory columns. Works only if the actual column value contains an empty spaces. Does not allow strings to be emptied."}),e.jsx(w,{children:"This feature is enabled by default on WordPress tables."}),e.jsx(w,{sx:{fontWeight:"bold"},children:"Do NOT change the default unless you really need to!"})]})]})},Ae=({appId:s,app:n,relationship:t,metaData:i,isRelationTable:r})=>{l.debug(s,n,t,i);const o=_(),a=E(s),[m,v]=b.useState(t.sql!==void 0&&t.sql!==""),[g,d]=b.useState(r?t.relationJoins.split(",").map(c=>{const p=c.split("=");return{masterColumn:p[0],detailColumn:p[1]??""}}):t.joins.split(",").map(c=>{const p=c.split("=");return{masterColumn:p[0],detailColumn:p[1]??""}}));l.debug("joins",g),b.useEffect(()=>{const c={...t};r?c.relationJoins=g.map(p=>p.masterColumn+"="+p.detailColumn).join(","):c.joins=g.map(p=>p.masterColumn+"="+p.detailColumn).join(","),o(se({appId:s,relationship:c})),a(!0)},[g]);const C=r?t.tbl:i.app.container[0].cnt_tbl,R=r?t.cls:i.app.container[0].cnt_cls===void 0||i.app.container[0].cnt_cls===null||i.app.container[0].cnt_cls===""?{}:JSON.parse(i.app.container[0].cnt_cls),x=r?n.appRelationTable:n.appTable,k=r?n.appRelationColumns:n.appColumns;return e.jsxs(u,{children:[...g.map((c,p)=>e.jsxs(u,{sx:{display:"grid",marginTop:"10px"},children:[e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"minmax(0, 1fr) 20px minmax(0, 1fr) auto",alignItems:"center"},children:[e.jsxs(F,{children:[e.jsx(be,{variant:"outlined",children:"master *"}),e.jsxs(ye,{MenuProps:{id:"pp-select-menu"},label:"master *",value:c.masterColumn,onChange:S=>{const U=[...g];U[p].masterColumn=S.target.value,d(U),a(!0)},children:[...R.map(S=>S.isSelected?e.jsxs(te,{value:S.columnName,children:[C,".",S.columnName]}):null)]})]}),e.jsx(u,{sx:{textAlign:"center"},children:"="}),e.jsxs(F,{children:[e.jsx(be,{variant:"outlined",children:"detail *"}),e.jsxs(ye,{MenuProps:{id:"pp-select-menu"},label:"detail *",value:c.detailColumn,onChange:S=>{const U=[...g];U[p].detailColumn=S.target.value,d(U),a(!0)},children:[...k.map(S=>S.isSelected?e.jsxs(te,{value:S.columnName,children:[x,".",S.columnName]}):null)]})]}),e.jsx(u,{children:p===0?e.jsx(fe,{title:"Add condition",children:e.jsx(B,{color:"primary",onClick:()=>{const S=[...g];S.push({masterColumn:"",detailColumn:""}),d(S),a(!0)},children:e.jsx(Is,{})})}):e.jsx(fe,{title:"Delete condition",children:e.jsx(B,{color:"primary",onClick:()=>{const S=[...g];S.splice(p,1),d(S),a(!0)},children:e.jsx(et,{})})})})]}),e.jsx(u,{children:e.jsx(F,{children:e.jsx(w,{children:"Updating requires a table reload."})})})]})),e.jsx(u,{sx:{marginTop:"20px"},children:m?e.jsxs(F,{fullWidth:!0,children:[e.jsx(O,{fullWidth:!0,label:"Optional conditions",multiline:!0,minRows:1,maxRows:10,value:r?t.relationSql:t.sql,placeholder:"Use this field to add additional conditions to show specific details only or leave blank",onChange:c=>{const p={...t};r?p.relationSql=c.target.value:p.sql=c.target.value,o(se({appId:s,relationship:p})),a(!0)}}),e.jsx(ot,{})]}):e.jsxs(ee,{onClick:()=>v(!0),sx:{textDecoration:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx(Ts,{}),e.jsx("span",{children:"Add SQL conditions"})]})}),t.cardinality===G.ONE_TO_ONE&&e.jsx(u,{sx:{marginTop:"20px"},children:e.jsx(F,{fullWidth:!0,children:e.jsx(w,{children:"A join for a 1:1 relationship must return exactly one record. An error is shown when a detail query returns more than 1 record."})})})]})},Ut=({appId:s,metaData:n,isUpdating:t,initialRelationships:i,initialTitle:r,embedded:o,enableWizard:a})=>{const m=_(),v=Be(s),g=E(s),d=lt(),[C,R]=b.useState(o);l.debug("typeSelected",C);const x=$(h=>rs(h));l.debug("relationship",x),b.useEffect(()=>{const h={...x};h.title=d.appTitle??"",h.dbs=d.appDatabase??"",h.tbl=d.appTable??"",h.cls=d.appColumns,h.relationTbl=d.appRelationTable??"",h.relationCls=d.appRelationColumns,m(se({appId:s,relationship:h}))},[d.appDatabase,d.appTable,d.appRelationTable,d.appColumns,d.appRelationColumns,d.appTitle]);const[k,c]=b.useState(""),p=b.useMemo(()=>x.cardinality===G.MANY_TO_MANY?["Relationship title","Select join table","Define join table join condition","Select relation table","Define relation table join condition"]:["Relationship title","Select data source","Define join condition"],[x.cardinality]),[S,U]=b.useState(0),Z=h=>{switch(l.debug(h),h){case 0:if(d.appTitle===""||d.appTitle===null||r!==d.appTitle&&i.filter(j=>j.title===d.appTitle).length>0)return c("title"),!1;c("");break;case 1:if(d.appDatabase===""||d.appDatabase===null||d.appTable===""||d.appTable===null||d.appColumns.filter(j=>j.isSelected===!0).length===0)return!1;c("");break;case 2:if(x.joins==="=")return!1;c("");break;case 3:if(d.appRelationColumns.filter(j=>j.isSelected===!0).length===0)return!1;c("");break;case 4:if(x.relationJoins==="=")return!1;c("");break}return!0},V=h=>(l.debug(h),e.jsxs(u,{sx:{display:"grid",gridTemplateColumns:"1fr 1fr",justifyContent:"space-between",alignItems:"center",gap:"5px"},children:[h===0?e.jsx(u,{}):e.jsx(M,{variant:"contained",startIcon:e.jsx(vs,{}),onClick:()=>{U(h-1)},children:"Previous"}),h===2&&x.cardinality!==G.MANY_TO_MANY||h===4&&x.cardinality===G.MANY_TO_MANY?e.jsx(M,{variant:"contained",startIcon:e.jsx(ws,{}),onClick:()=>{Z(h)&&U(h+1)},children:"Finish"}):e.jsx(M,{variant:"contained",endIcon:e.jsx(Oe,{}),onClick:()=>{Z(h)&&U(h+1)},children:"Next"})]}));return C?e.jsxs(e.Fragment,{children:[e.jsx(xt,{activeStep:S,orientation:"vertical",sx:{marginBottom:0},children:p.map((h,j)=>e.jsxs(ht,{children:[e.jsx(gt,{children:h}),e.jsx(Js,{children:e.jsxs(u,{sx:{display:"grid",gap:"20px",marginTop:"20px"},children:[j===0&&e.jsxs(e.Fragment,{children:[e.jsx(O,{type:"text",label:"Title",error:k==="title",value:d.appTitle,fullWidth:!0,required:!0,helperText:"Container title (must be unique witin this form)",autoComplete:"off",onChange:f=>{m(ls({appTitle:f.target.value}));const y={...x};y.title=f.target.value,m(se({appId:s,relationship:y})),g(!0)}}),V(j)]}),j===1&&e.jsxs(e.Fragment,{children:[e.jsx(at,{}),e.jsx(_e,{isDetail:!0}),e.jsx(Re,{app:d}),V(j)]}),j===2&&e.jsxs(e.Fragment,{children:[e.jsx(Ae,{appId:s,app:d,metaData:n,relationship:x}),V(j)]}),x.cardinality===G.MANY_TO_MANY&&j===3&&e.jsxs(e.Fragment,{children:[e.jsx(_e,{isDetail:!0,isRelationTable:!0}),e.jsx(Re,{app:d,isRelationTable:!0}),V(j)]}),x.cardinality===G.MANY_TO_MANY&&j===4&&e.jsxs(e.Fragment,{children:[e.jsx(Ae,{appId:s,app:d,metaData:n,relationship:x,isRelationTable:!0}),V(j)]})]})})]},h))}),S===p.length&&e.jsxs(u,{sx:{marginTop:"20px",display:"grid",gap:"20px"},children:[e.jsx(u,{children:"Relationship wizard successfully completed. Click button below to activate."}),e.jsx(M,{fullWidth:!0,variant:"contained",onClick:()=>{const h={app_id:n.app.container[0].app_id,app_title:x.title,app_dbs:x.dbs,app_tbl:x.tbl,app_cls:x.cls},j={cnt_id_master:n.app.container[0].cnt_id,cardinality:x.cardinality,join_condition:x.joins,sql:x.sql};x.cardinality===G.MANY_TO_MANY&&(j.relation_tbl=x.relationTbl,j.relation_cls=x.relationCls,j.relation_join_condition=x.relationJoins,j.relation_sql=x.relationSql),h.app_relation=JSON.stringify(j),t?(h.app_cnt=d.appCntId,ut(h,f=>{l.debug(f),(f==null?void 0:f.code)==="ok"&&(f==null?void 0:f.message)===""?(a(!1),P("Relationship updated",{variant:"success"}),v(n,()=>{P(D.contactSupport,{variant:"error"})}),g(!1)):P(D.contactSupport,{variant:"error"})},f=>{l.error(f),P(D.contactSupport,{variant:"error"})},!1)):pt(h,f=>{l.debug(f),(f==null?void 0:f.code)==="ok"&&(f==null?void 0:f.message)===""?(a(!1),P("Relationship created",{variant:"success"}),v(n,()=>{P(D.contactSupport,{variant:"error"})}),g(!1)):P(D.contactSupport,{variant:"error"})},f=>{l.error(f),P(D.contactSupport,{variant:"error"})},!1)},children:t?"Update relationship":"Create relationship"})]})]}):e.jsx(u,{children:e.jsxs(F,{fullWidth:!0,children:[e.jsxs(dt,{fullWidth:!0,color:"primary",exclusive:!0,value:x.cardinality,onChange:(h,j)=>{if(j!==null){const f={...x};f.cardinality=j,m(se({appId:s,relationship:f}))}g(!0),R(!0)},children:[e.jsx(xe,{value:G.ONE_TO_ONE,children:"1:1"}),e.jsx(xe,{value:G.ONE_TO_MANY,children:"1:m"}),e.jsx(xe,{value:G.MANY_TO_MANY,children:"m:m"})]}),e.jsx(w,{children:"Select cardinality."})]})})},At=({children:s,appId:n,embedded:t,enableWizard:i})=>{const r=E(n),o=()=>e.jsxs(u,{children:[e.jsx(u,{sx:{paddingTop:"30px"},children:s}),e.jsx(fe,{title:"Close",sx:{position:"absolute",top:0,right:"8px"},children:e.jsx(B,{onClick:()=>{i(!1),r(!1)},children:e.jsx(Ve,{})})})]});return t?e.jsxs(u,{sx:{marginLeft:"-10px",marginRight:"-10px",position:"relative"},children:[e.jsx(ze,{component:"div",sx:{height:"40px",display:"flex",alignItems:"center",marginBottom:"-10px"},children:"Relationship Wizard"}),o()]}):e.jsx(u,{children:e.jsxs("fieldset",{className:"pp-fieldset",style:{padding:"20px",position:"relative"},children:[e.jsx("legend",{children:"Relationship Wizard"}),o()]})})},Pt=({appId:s,updateSettings:n})=>{var V;l.debug(s);const t=_();Fs();const i=jt(s),r=_s(s);Rs(),Be(s);const[o,a]=b.useState(!1);l.debug("wizardOn",o);const[m,v]=b.useState(!1);l.debug("wizardIsUpdating",m);const[g,d]=b.useState("");l.debug("wizardTitle",g);const C=ne(s);l.debug(C);const[R,x]=b.useState([]);l.debug(R),b.useEffect(()=>{var j,f;const h=[];if(r!==void 0&&r.length>0&&((j=C==null?void 0:C.app)==null?void 0:j.container)!==void 0&&Array.isArray((f=C==null?void 0:C.app)==null?void 0:f.container)){const y=C.app.container[0].cnt_id,re=C.app.container[0].cnt_tbl;for(let A=0;A<r.length;A++){const le=Pe(r[A].container);if(le!==null&&le.cnt_id_master===y){const We=r[A].appId;h.push({appId:We,dbAppId:r[A].container.app_id,cntId:r[A].container.cnt_id,title:r[A].container.cnt_title,dbs:r[A].container.cnt_dbs,tbl:r[A].container.cnt_tbl,cls:r[A].container.cnt_cls===void 0||r[A].container.cnt_cls===null||r[A].container.cnt_cls===""?{}:JSON.parse(r[A].container.cnt_cls),relation:le,parentTbl:re})}}}x(h)},[s,(V=C==null?void 0:C.app)==null?void 0:V.container,r]),b.useState(""),b.useState(-1);const[k,c]=b.useState(!1);b.useState("");const[p,S]=b.useState(!1),[U,Z]=b.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(H,{defaultExpanded:!1,disableGutters:!0,children:[e.jsx(q,{expandIcon:e.jsx(W,{}),children:"Relationships"}),e.jsxs(Y,{children:[e.jsx(u,{sx:{marginBottom:"30px"},children:o?e.jsx(e.Fragment,{children:!m&&e.jsx(At,{appId:s,embedded:!1,enableWizard:a,children:e.jsx(Ut,{appId:s,embedded:!1,metaData:C,isUpdating:m,enableWizard:a,initialRelationships:R,initialTitle:""})})}):e.jsx(M,{variant:"contained",fullWidth:!0,disabled:!0,startIcon:e.jsx(ks,{}),endIcon:e.jsx(Oe,{}),onClick:()=>{},children:"Start relationship wizard"})}),!1,e.jsx(e.Fragment,{children:R.length>0&&e.jsx(u,{sx:{marginTop:"30px"},children:e.jsxs(F,{fullWidth:!0,children:[e.jsx(be,{variant:"outlined",children:"Display type"}),e.jsxs(ye,{MenuProps:{id:"pp-select-menu"},value:i,label:"Display type",onChange:h=>{t(as({appId:s,displayType:h.target.value})),n(!0)},children:[e.jsx(te,{value:de.ACOORDION,children:"Accordion"}),e.jsx(te,{value:de.TAB,children:"Tabs"}),e.jsx(te,{value:de.TITLE,children:"Titles"})]}),e.jsx(w,{children:"Select how relationships should be displayed."})]})})}),e.jsxs(w,{component:"div",sx:{marginTop:"30px"},children:[e.jsxs(ee,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>S(!p),children:[e.jsx(je,{}),"How to use the relationship wizard?"]}),p&&e.jsxs(u,{sx:{marginTop:"20px",marginBottom:"30px",display:"grid",gap:"20px"},children:[e.jsx(u,{children:"The following relationship types are supported:"}),e.jsxs("ul",{style:{listStyle:"disc",padding:"0 40px"},children:[e.jsx("li",{children:"one to one relationship (1:1)"}),e.jsx("li",{children:"one to many relationship (1:m)"}),e.jsx("li",{children:"many to many relationship (m:m)"})]}),e.jsxs(u,{children:["To add a relationship, click the ",e.jsx("strong",{children:"start relationship wizard"})," button and follow the instructions. Relationships are added to the bottom of the form. Use the display type to define how relationships are displayed (possible values are: ",e.jsx("strong",{children:"Accordion"}),", ",e.jsx("strong",{children:"Tabs"})," or ",e.jsx("strong",{children:"Titles"}),")."]})]})]}),e.jsxs(w,{component:"div",children:[e.jsxs(ee,{sx:{textDecoration:"none",cursor:"pointer",display:"inline-flex","& svg":{fontSize:"1rem",marginRight:"2px"}},onClick:()=>Z(!U),children:[e.jsx(je,{}),"How to create a multi level master detail form?"]}),U&&e.jsx(u,{sx:{marginTop:"20px",display:"grid",gap:"20px"},children:e.jsxs(u,{children:["Add a ",e.jsx("strong",{children:"relationship"})," to the ",e.jsx("strong",{children:"master table"})," using the ",e.jsx("strong",{children:"relationship wizard"}),". Open the ",e.jsx("strong",{children:"detail table"})," and navigate to the detail form using the new or edit button. Open the ",e.jsx("strong",{children:"Form Builder"})," of the detail form. The button to access the ",e.jsx("strong",{children:"Form Builder"})," is available from the table footer. Open the ",e.jsx("strong",{children:"Relationships"})," section and start the ",e.jsx("strong",{children:"relationship wizard"}),"."]})})]}),e.jsx(K,{})]})]}),k&&e.jsx(Se,{title:"Delete Relationship?",message:"Are you sure you want to delete this relationship? This action cannot be undone!",open:k,setOpen:c,onConfirm:()=>{}})]})},Lt=()=>{const s=$(n=>os(n));return l.debug("isRelationForm",s),s},Et=({appId:s})=>{l.debug(s),_(),E(s);const n=Lt(),t=Ee(s),i=r=>{l.debug(r)};return e.jsxs(e.Fragment,{children:[n!==!0&&e.jsx(Pt,{appId:s,updateSettings:i}),e.jsx(wt,{appId:s,formSettings:t}),e.jsx(Ft,{appId:s,formSettings:t,updateSettings:i}),e.jsx(_t,{formSettings:t,updateSettings:i}),e.jsx(Rt,{formSettings:t,updateSettings:i}),e.jsx(kt,{appId:s,formSettings:t})]})},ji=({appId:s})=>{var j,f;l.debug(s);const n=_(),t=vt(),[i,r]=b.useState(ge(Q.getState(),s));l.debug(i);const[o,a]=b.useState(ds(Q.getState(),s));l.debug(o);const m=()=>gs(Q.getState(),s),v=y=>{n(Le({appId:s,isUpdated:y}))},[g,d]=b.useState(!1),C=((j=Fe)==null?void 0:j.palette.mode)===cs.LIGHT?(f=Fe)==null?void 0:f.palette.primary.main:"",R=y=>{n(us({anchor:y}))},x=()=>{i!==void 0&&n(xs({appId:s,formState:i}))},k=()=>{n(hs({})),v(!1)},c=()=>{m()?d(!0):(x(),k())},p=()=>{Zs(s,rt.GLOBAL,y=>{if(l.debug(y),y!=null&&y.code&&(y==null?void 0:y.message)!==void 0)switch(y.code){case"ok":r(ge(Q.getState(),s)),P(y.message,{variant:"success"});break;case"info":P(y.message,{variant:"info"});break;default:l.error(y),P(y.message??D.contactSupport,{variant:"error"})}else l.error(y),P(D.contactSupport,{variant:"error"})},y=>{l.error("error",y),P(y??D.contactSupport,{variant:"error"})}),v(!1)},S=()=>{m()?(p(),setTimeout(()=>{k()},1e3)):k()},[U,Z]=b.useState("1"),V=(y,re)=>{Z(re)},h=$(y=>ps(y,s));return e.jsx(e.Fragment,{children:h&&e.jsxs(e.Fragment,{children:[e.jsxs(Ds,{closeDrawer:c,children:[e.jsx(Us,{position:"static",elevation:4,sx:{borderRadius:0},children:e.jsxs(As,{className:"pp-setting-toolbar",sx:{borderRadius:0},children:[e.jsx(ze,{variant:"h5",noWrap:!0,component:"div",className:"unselectable",sx:{flexGrow:1,display:{xs:"none",sm:"block"},paddingLeft:"6px"},children:"Form Builder"}),e.jsx(X,{title:"Dock to left",position:"bottom",children:e.jsx(B,{onClick:()=>{R(ve.LEFT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx(Ms,{})})}),e.jsx(X,{title:"Dock to right",position:"bottom",children:e.jsx(B,{onClick:()=>{R(ve.RIGHT)},size:"large",color:"inherit",sx:{fontSize:"1em"},children:e.jsx($s,{})})}),e.jsx(X,{title:"Close",position:"bottom",children:e.jsx(B,{onClick:c,size:"large",color:"inherit",sx:{fontSize:"1.4em"},children:e.jsx(Ve,{})})})]})}),e.jsx(ke,{className:"pp-settings-container",children:e.jsx(Ue,{sx:{padding:0,margin:0},children:e.jsxs(Ks,{value:U,children:[e.jsxs(Xs,{variant:"fullWidth",textColor:"primary",onChange:V,sx:{width:"100%",height:"80px",padding:0,margin:0,backgroundColor:"rgb(242, 242, 242)"},children:[e.jsx(he,{label:"Form",value:"1",sx:{fontWeight:"bold",fontSize:"110%",height:"80px"}}),e.jsx(he,{label:"Columns",value:"2",sx:{fontWeight:"bold",fontSize:"110%",height:"80px"}}),t!==!0&&e.jsx(he,{label:"Theme",value:"3",sx:{fontWeight:"bold",fontSize:"110%",height:"80px"}})]}),e.jsxs(u,{sx:{margin:0,padding:0,overflowY:"auto",height:"calc(100vh - 250px)","& > div.MuiTabPanel-root":{padding:0}},children:[e.jsx(pe,{value:"1",children:e.jsx(Et,{appId:s})}),e.jsx(pe,{value:"2",children:e.jsx(Tt,{appId:s})}),t!==!0&&e.jsx(pe,{value:"3",children:e.jsx(mt,{appId:s,source:Ne.FORM,setIsUpdated:v})})]})]})})}),e.jsx(ke,{className:"pp-setting-footer",sx:{borderRadius:0,backgroundColor:C},children:e.jsxs(Ue,{className:"pp-setting-footer-buttons",sx:{borderRadius:0},children:[e.jsx(M,{variant:"outlined",className:"footer_action_button_apply",onClick:p,children:"Apply"}),e.jsx(M,{variant:"outlined",className:"footer_action_button",onClick:S,children:"OK"}),e.jsx(M,{variant:"outlined",className:"footer_action_button",onClick:c,children:"Cancel"})]})})]}),e.jsx(Se,{title:"Close Form Builder?",message:"All uncommitted changes will be lost!",open:g,setOpen:d,onConfirm:()=>{x(),k()},onKeep:()=>{k()}})]})})};export{ji as default};
